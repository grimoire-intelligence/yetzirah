{"version":3,"sources":["../src/utils/position.js","../src/utils/key-nav.js","../src/utils/click-outside.js","../src/menu.js"],"names":["position","anchor","floating","options","placement","offset","anchorRect","floatingRect","viewport","x","y","finalPlacement","createKeyNav","getItems","orientation","wrap","autoActivate","onActivate","prevKey","nextKey","e","items","currentIndex","newIndex","clickOutside","element","callback","ignore","handleClick","menuId","YtzMenu","#trigger","#popup","#menuId","#keyNav","#clickOutsideHandler","#lastCloseTime","#setup","#cleanup","name","oldVal","newVal","#showMenu","#hideMenu","v","item","#handleTriggerClick","#handleKeyDown","focused","basePlacement","#updatePosition","YtzMenuItem","#handleClick","menu"],"mappings":"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","file":"menu.js","sourcesContent":["/**\r\n * Position utility for tooltips, menus, popovers.\r\n * Places an element relative to an anchor with flip/shift logic.\r\n *\r\n * @module @grimoire/yetzirah-core/utils/position\r\n * @internal Not exported from package\r\n *\r\n * Limitations (by design):\r\n * - Does not handle nested scroll containers\r\n * - Does not support virtual elements\r\n * - No middleware system\r\n */\r\n\r\n/**\r\n * Position a floating element relative to an anchor.\r\n *\r\n * @param {HTMLElement} anchor - Element to position relative to\r\n * @param {HTMLElement} floating - Element to position\r\n * @param {Object} [options] - Positioning options\r\n * @param {'top'|'bottom'|'left'|'right'} [options.placement='top'] - Preferred placement\r\n * @param {number} [options.offset=8] - Gap between anchor and floating element\r\n * @returns {{ x: number, y: number, placement: string }}\r\n */\r\nexport function position(anchor, floating, options = {}) {\r\n  const { placement = 'top', offset = 8 } = options\r\n\r\n  const anchorRect = anchor.getBoundingClientRect()\r\n  const floatingRect = floating.getBoundingClientRect()\r\n  const viewport = { width: window.innerWidth, height: window.innerHeight }\r\n\r\n  let x, y\r\n  let finalPlacement = placement\r\n\r\n  // Calculate position based on placement\r\n  switch (placement) {\r\n    case 'top':\r\n      x = anchorRect.left + (anchorRect.width - floatingRect.width) / 2\r\n      y = anchorRect.top - floatingRect.height - offset\r\n      break\r\n    case 'bottom':\r\n      x = anchorRect.left + (anchorRect.width - floatingRect.width) / 2\r\n      y = anchorRect.bottom + offset\r\n      break\r\n    case 'left':\r\n      x = anchorRect.left - floatingRect.width - offset\r\n      y = anchorRect.top + (anchorRect.height - floatingRect.height) / 2\r\n      break\r\n    case 'right':\r\n      x = anchorRect.right + offset\r\n      y = anchorRect.top + (anchorRect.height - floatingRect.height) / 2\r\n      break\r\n  }\r\n\r\n  // Flip if outside viewport\r\n  if (placement === 'top' && y < 0) {\r\n    y = anchorRect.bottom + offset\r\n    finalPlacement = 'bottom'\r\n  } else if (placement === 'bottom' && y + floatingRect.height > viewport.height) {\r\n    y = anchorRect.top - floatingRect.height - offset\r\n    finalPlacement = 'top'\r\n  } else if (placement === 'left' && x < 0) {\r\n    x = anchorRect.right + offset\r\n    finalPlacement = 'right'\r\n  } else if (placement === 'right' && x + floatingRect.width > viewport.width) {\r\n    x = anchorRect.left - floatingRect.width - offset\r\n    finalPlacement = 'left'\r\n  }\r\n\r\n  // Shift to stay in viewport\r\n  if (finalPlacement === 'top' || finalPlacement === 'bottom') {\r\n    x = Math.max(0, Math.min(x, viewport.width - floatingRect.width))\r\n  } else {\r\n    y = Math.max(0, Math.min(y, viewport.height - floatingRect.height))\r\n  }\r\n\r\n  return { x, y, placement: finalPlacement }\r\n}\r\n","/**\r\n * Keyboard navigation utility for arrow key navigation.\r\n * @module @grimoire/yetzirah-core/utils/key-nav\r\n * @internal Not exported from package\r\n */\r\n\r\n/**\r\n * Creates keyboard navigation for a set of elements.\r\n * @param {() => HTMLElement[]} getItems - Function returning navigable elements\r\n * @param {Object} options\r\n * @param {'horizontal'|'vertical'} [options.orientation='horizontal']\r\n * @param {boolean} [options.wrap=true]\r\n * @param {boolean} [options.autoActivate=true]\r\n * @param {(item: HTMLElement) => void} [options.onActivate]\r\n * @returns {{ handleKeyDown: (e: KeyboardEvent) => void }}\r\n */\r\nexport function createKeyNav(getItems, options = {}) {\r\n  const { orientation = 'horizontal', wrap = true, autoActivate = true, onActivate } = options\r\n  const prevKey = orientation === 'horizontal' ? 'ArrowLeft' : 'ArrowUp'\r\n  const nextKey = orientation === 'horizontal' ? 'ArrowRight' : 'ArrowDown'\r\n\r\n  return {\r\n    handleKeyDown(e) {\r\n      const items = getItems()\r\n      const currentIndex = items.indexOf(document.activeElement)\r\n      if (currentIndex === -1) return\r\n\r\n      let newIndex = currentIndex\r\n      if (e.key === prevKey) {\r\n        newIndex = currentIndex - 1\r\n        if (newIndex < 0) newIndex = wrap ? items.length - 1 : 0\r\n      } else if (e.key === nextKey) {\r\n        newIndex = currentIndex + 1\r\n        if (newIndex >= items.length) newIndex = wrap ? 0 : items.length - 1\r\n      } else if (e.key === 'Home') {\r\n        newIndex = 0\r\n      } else if (e.key === 'End') {\r\n        newIndex = items.length - 1\r\n      } else {\r\n        return\r\n      }\r\n\r\n      e.preventDefault()\r\n      items[newIndex].focus()\r\n      if (autoActivate && onActivate) onActivate(items[newIndex])\r\n    }\r\n  }\r\n}\r\n","/**\r\n * Click outside utility for dismissing popups.\r\n * @module @grimoire/yetzirah-core/utils/click-outside\r\n * @internal Not exported from package\r\n */\r\n\r\n/**\r\n * Creates a click outside listener.\r\n * @param {HTMLElement} element - Element to detect clicks outside of\r\n * @param {Function} callback - Called when click outside occurs\r\n * @param {Object} [options]\r\n * @param {HTMLElement} [options.ignore] - Additional element to ignore clicks on (e.g., trigger)\r\n * @returns {{ destroy: () => void }}\r\n */\r\nexport function clickOutside(element, callback, options = {}) {\r\n  const { ignore } = options\r\n\r\n  const handleClick = (e) => {\r\n    if (element.contains(e.target)) return\r\n    if (ignore && ignore.contains(e.target)) return\r\n    callback(e)\r\n  }\r\n\r\n  // Use capture to catch clicks before they're stopped\r\n  document.addEventListener('click', handleClick, true)\r\n\r\n  return {\r\n    destroy() {\r\n      document.removeEventListener('click', handleClick, true)\r\n    }\r\n  }\r\n}\r\n","/**\r\n * ytz-menu - Dropdown menu with keyboard navigation.\r\n * Opens on trigger click, positions relative to trigger, closes on click outside/escape.\r\n *\r\n * @module @grimoire/yetzirah-core/menu\r\n * @example\r\n * <ytz-menu>\r\n *   <button slot=\"trigger\">Open Menu</button>\r\n *   <ytz-menuitem>Edit</ytz-menuitem>\r\n *   <ytz-menuitem>Delete</ytz-menuitem>\r\n * </ytz-menu>\r\n *\r\n * @example\r\n * <ytz-menu placement=\"bottom-start\">\r\n *   <button slot=\"trigger\">Actions</button>\r\n *   <ytz-menuitem value=\"edit\">Edit</ytz-menuitem>\r\n *   <ytz-menuitem disabled>Archive</ytz-menuitem>\r\n * </ytz-menu>\r\n */\r\n\r\nimport { position } from './utils/position.js'\r\nimport { createKeyNav } from './utils/key-nav.js'\r\nimport { clickOutside } from './utils/click-outside.js'\r\n\r\nlet menuId = 0\r\n\r\n/**\r\n * @class YtzMenu\r\n * @extends HTMLElement\r\n */\r\nclass YtzMenu extends HTMLElement {\r\n  static observedAttributes = ['open', 'placement']\r\n\r\n  /** @type {HTMLElement|null} */\r\n  #trigger = null\r\n  /** @type {HTMLElement|null} */\r\n  #popup = null\r\n  /** @type {string|null} */\r\n  #menuId = null\r\n  /** @type {ReturnType<typeof createKeyNav>|null} */\r\n  #keyNav = null\r\n  /** @type {ReturnType<typeof clickOutside>|null} */\r\n  #clickOutsideHandler = null\r\n  /** @type {number} */\r\n  #lastCloseTime = 0\r\n\r\n  connectedCallback() {\r\n    this.#setup()\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    this.#cleanup()\r\n  }\r\n\r\n  attributeChangedCallback(name, oldVal, newVal) {\r\n    if (!this.isConnected) return\r\n    if (name === 'open') {\r\n      newVal !== null ? this.#showMenu() : this.#hideMenu()\r\n    }\r\n  }\r\n\r\n  /** @returns {boolean} */\r\n  get open() { return this.hasAttribute('open') }\r\n  set open(v) { v ? this.setAttribute('open', '') : this.removeAttribute('open') }\r\n\r\n  /** @returns {string} */\r\n  get placement() { return this.getAttribute('placement') || 'bottom-start' }\r\n  set placement(v) { v ? this.setAttribute('placement', v) : this.removeAttribute('placement') }\r\n\r\n  #setup() {\r\n    this.#trigger = this.querySelector('[slot=\"trigger\"]')\r\n    if (!this.#trigger) return\r\n\r\n    this.#menuId = `ytz-menu-${++menuId}`\r\n\r\n    // Create popup wrapper for menu items\r\n    this.#popup = document.createElement('div')\r\n    this.#popup.setAttribute('role', 'menu')\r\n    this.#popup.id = this.#menuId\r\n    this.#popup.hidden = true\r\n\r\n    // Move all menuitem children into popup\r\n    const items = [...this.querySelectorAll('ytz-menuitem')]\r\n    items.forEach(item => this.#popup.appendChild(item))\r\n    this.appendChild(this.#popup)\r\n\r\n    // ARIA on trigger\r\n    this.#trigger.setAttribute('aria-haspopup', 'menu')\r\n    this.#trigger.setAttribute('aria-controls', this.#menuId)\r\n    this.#trigger.setAttribute('aria-expanded', 'false')\r\n\r\n    // Keyboard navigation\r\n    this.#keyNav = createKeyNav(\r\n      () => [...this.#popup.querySelectorAll('ytz-menuitem:not([disabled])')],\r\n      { orientation: 'vertical', wrap: true, autoActivate: false }\r\n    )\r\n\r\n    this.#trigger.addEventListener('click', this.#handleTriggerClick)\r\n    this.addEventListener('keydown', this.#handleKeyDown)\r\n  }\r\n\r\n  #cleanup() {\r\n    this.#trigger?.removeEventListener('click', this.#handleTriggerClick)\r\n    this.removeEventListener('keydown', this.#handleKeyDown)\r\n    this.#clickOutsideHandler?.destroy()\r\n  }\r\n\r\n  #handleTriggerClick = () => { this.open = !this.open }\r\n\r\n  #handleKeyDown = (e) => {\r\n    if (!this.open) return\r\n\r\n    if (e.key === 'Escape') {\r\n      e.preventDefault()\r\n      this.open = false\r\n      this.#trigger?.focus()\r\n      return\r\n    }\r\n\r\n    this.#keyNav?.handleKeyDown(e)\r\n\r\n    if (e.key === 'Enter' || e.key === ' ') {\r\n      const focused = this.#popup?.querySelector('ytz-menuitem:focus')\r\n      if (focused && !focused.hasAttribute('disabled')) {\r\n        e.preventDefault()\r\n        focused.click()\r\n      }\r\n    }\r\n  }\r\n\r\n  #showMenu() {\r\n    if (!this.#trigger || !this.#popup) return\r\n    // Prevent re-opening if we just closed (e.g., click-outside + toggle in same event)\r\n    if (performance.now() - this.#lastCloseTime < 10) {\r\n      // Remove attribute to keep state consistent since we're blocking the open\r\n      this.removeAttribute('open')\r\n      return\r\n    }\r\n\r\n    // Pre-position as fixed but invisible to get correct layout\r\n    this.#popup.style.position = 'fixed'\r\n    this.#popup.style.visibility = 'hidden'\r\n    this.#popup.hidden = false\r\n\r\n    // Force synchronous reflow so popup has layout dimensions\r\n    void this.#popup.offsetHeight\r\n\r\n    // Calculate and apply position\r\n    const basePlacement = this.placement.split('-')[0] || 'bottom'\r\n    const { x, y } = position(this.#trigger, this.#popup, {\r\n      placement: basePlacement,\r\n      offset: 4\r\n    })\r\n    this.#popup.style.left = `${x}px`\r\n    this.#popup.style.top = `${y}px`\r\n\r\n    // Now make visible\r\n    this.#popup.style.visibility = ''\r\n    this.#trigger.setAttribute('aria-expanded', 'true')\r\n\r\n    const firstItem = this.#popup.querySelector('ytz-menuitem:not([disabled])')\r\n    firstItem?.focus()\r\n\r\n    // Defer click-outside setup to next event loop tick to avoid triggering on same click\r\n    setTimeout(() => {\r\n      // Only set up if still open (user might have closed it already)\r\n      if (!this.open) return\r\n      this.#clickOutsideHandler = clickOutside(this.#popup, () => {\r\n        this.open = false\r\n      }, { ignore: this.#trigger })\r\n    }, 0)\r\n\r\n    window.addEventListener('scroll', this.#updatePosition, { passive: true, capture: true })\r\n    window.addEventListener('resize', this.#updatePosition, { passive: true })\r\n\r\n    this.dispatchEvent(new CustomEvent('open', { bubbles: true }))\r\n  }\r\n\r\n  #hideMenu() {\r\n    if (!this.#trigger || !this.#popup) return\r\n\r\n    // Record close time to prevent re-opening in the same event\r\n    this.#lastCloseTime = performance.now()\r\n\r\n    this.#popup.hidden = true\r\n    this.#trigger.setAttribute('aria-expanded', 'false')\r\n\r\n    this.#clickOutsideHandler?.destroy()\r\n    this.#clickOutsideHandler = null\r\n    window.removeEventListener('scroll', this.#updatePosition, { capture: true })\r\n    window.removeEventListener('resize', this.#updatePosition)\r\n\r\n    this.dispatchEvent(new CustomEvent('close', { bubbles: true }))\r\n  }\r\n\r\n  #updatePosition = () => {\r\n    if (!this.#trigger || !this.#popup) return\r\n\r\n    const basePlacement = this.placement.split('-')[0] || 'bottom'\r\n    const { x, y } = position(this.#trigger, this.#popup, {\r\n      placement: basePlacement,\r\n      offset: 4\r\n    })\r\n\r\n    this.#popup.style.position = 'fixed'\r\n    this.#popup.style.left = `${x}px`\r\n    this.#popup.style.top = `${y}px`\r\n  }\r\n\r\n  show() { this.open = true }\r\n  hide() { this.open = false }\r\n  toggle() { this.open = !this.open }\r\n}\r\n\r\n/**\r\n * ytz-menuitem - Individual menu item.\r\n * @attr disabled - When present, item is not selectable\r\n * @attr value - Optional value for select event\r\n */\r\nclass YtzMenuItem extends HTMLElement {\r\n  connectedCallback() {\r\n    this.setAttribute('role', 'menuitem')\r\n    if (!this.hasAttribute('tabindex') && !this.hasAttribute('disabled')) {\r\n      this.setAttribute('tabindex', '-1')\r\n    }\r\n    if (this.hasAttribute('disabled')) {\r\n      this.setAttribute('aria-disabled', 'true')\r\n    }\r\n    this.addEventListener('click', this.#handleClick)\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    this.removeEventListener('click', this.#handleClick)\r\n  }\r\n\r\n  #handleClick = (e) => {\r\n    if (this.hasAttribute('disabled')) {\r\n      e.preventDefault()\r\n      e.stopPropagation()\r\n      return\r\n    }\r\n\r\n    const menu = this.closest('ytz-menu')\r\n    if (menu) {\r\n      this.dispatchEvent(new CustomEvent('select', {\r\n        bubbles: true,\r\n        detail: { value: this.getAttribute('value') || this.textContent?.trim() }\r\n      }))\r\n      menu.open = false\r\n    }\r\n  }\r\n\r\n  /** @returns {boolean} */\r\n  get disabled() { return this.hasAttribute('disabled') }\r\n  set disabled(v) {\r\n    if (v) {\r\n      this.setAttribute('disabled', '')\r\n      this.setAttribute('aria-disabled', 'true')\r\n      this.removeAttribute('tabindex')\r\n    } else {\r\n      this.removeAttribute('disabled')\r\n      this.removeAttribute('aria-disabled')\r\n      this.setAttribute('tabindex', '-1')\r\n    }\r\n  }\r\n\r\n  /** @returns {string|null} */\r\n  get value() { return this.getAttribute('value') }\r\n  set value(v) { v ? this.setAttribute('value', v) : this.removeAttribute('value') }\r\n}\r\n\r\ncustomElements.define('ytz-menu', YtzMenu)\r\ncustomElements.define('ytz-menuitem', YtzMenuItem)\r\n\r\nexport { YtzMenu, YtzMenuItem }\r\n"]}