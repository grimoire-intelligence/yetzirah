function p(d,t,e={}){let{placement:h="top",offset:o=8}=e,i=d.getBoundingClientRect(),r=t.getBoundingClientRect(),u={width:window.innerWidth,height:window.innerHeight},n,s,l=h;switch(h){case "top":n=i.left+(i.width-r.width)/2,s=i.top-r.height-o;break;case "bottom":n=i.left+(i.width-r.width)/2,s=i.bottom+o;break;case "left":n=i.left-r.width-o,s=i.top+(i.height-r.height)/2;break;case "right":n=i.right+o,s=i.top+(i.height-r.height)/2;break}return h==="top"&&s<0?(s=i.bottom+o,l="bottom"):h==="bottom"&&s+r.height>u.height?(s=i.top-r.height-o,l="top"):h==="left"&&n<0?(n=i.right+o,l="right"):h==="right"&&n+r.width>u.width&&(n=i.left-r.width-o,l="left"),l==="top"||l==="bottom"?n=Math.max(0,Math.min(n,u.width-r.width)):s=Math.max(0,Math.min(s,u.height-r.height)),{x:n,y:s,placement:l}}function f(d,t={}){let{orientation:e="horizontal",wrap:h=true,autoActivate:o=true,onActivate:i}=t,r=e==="horizontal"?"ArrowLeft":"ArrowUp",u=e==="horizontal"?"ArrowRight":"ArrowDown";return {handleKeyDown(n){let s=d(),l=s.indexOf(document.activeElement);if(l===-1)return;let a=l;if(n.key===r)a=l-1,a<0&&(a=h?s.length-1:0);else if(n.key===u)a=l+1,a>=s.length&&(a=h?0:s.length-1);else if(n.key==="Home")a=0;else if(n.key==="End")a=s.length-1;else return;n.preventDefault(),s[a].focus(),o&&i&&i(s[a]);}}}function b(d,t){customElements.get(d)||customElements.define(d,t);}var m=0,c=class extends HTMLElement{static observedAttributes=["open","multiple","disabled","placeholder"];#t=null;#e=null;#a=null;#i=new Set;#r=null;#s=false;connectedCallback(){this.#g(),this.hasAttribute("open")&&this.#m(),this.disabled&&this.#b();}disconnectedCallback(){this.#v();}attributeChangedCallback(t,e,h){this.isConnected&&(t==="open"&&(h!==null?this.#m():this.#y()),t==="multiple"&&this.#e?.setAttribute("aria-multiselectable",h!==null?"true":"false"),t==="disabled"&&this.#b());}get open(){return this.hasAttribute("open")}set open(t){t?this.setAttribute("open",""):this.removeAttribute("open");}get multiple(){return this.hasAttribute("multiple")}set multiple(t){t?this.setAttribute("multiple",""):this.removeAttribute("multiple");}get disabled(){return this.hasAttribute("disabled")}set disabled(t){t?this.setAttribute("disabled",""):this.removeAttribute("disabled");}get placeholder(){return this.getAttribute("placeholder")||"Select..."}set placeholder(t){this.setAttribute("placeholder",t);}get value(){return this.multiple?[...this.#i]:[...this.#i][0]||""}set value(t){this.#i.clear(),Array.isArray(t)?t.forEach(e=>this.#i.add(e)):t&&this.#i.add(t),this.#h(),this.#n();}get options(){return [...this.querySelectorAll("ytz-option")]}get selectedOptions(){return [...this.querySelectorAll("ytz-option[selected]")]}#g(){this.#r=`ytz-select-${++m}`,this.id||(this.id=this.#r),this.#t=this.querySelector('[slot="trigger"]'),this.#s=!!this.#t,this.#t||(this.#t=document.createElement("button"),this.#t.setAttribute("slot","trigger"),this.#t.className=this.getAttribute("trigger-class")||"",this.prepend(this.#t)),this.#e=document.createElement("div"),this.#e.id=`${this.#r}-listbox`,this.#e.setAttribute("role","listbox"),this.#e.hidden=true,this.multiple&&this.#e.setAttribute("aria-multiselectable","true"),this.querySelectorAll("ytz-option").forEach(t=>this.#e.appendChild(t)),this.appendChild(this.#e),this.#t.setAttribute("aria-haspopup","listbox"),this.#t.setAttribute("aria-expanded","false"),this.#t.setAttribute("aria-controls",this.#e.id),this.#a=f(()=>[...this.#e.querySelectorAll("ytz-option:not([disabled])")],{orientation:"vertical",wrap:true,autoActivate:false}),this.querySelectorAll("ytz-option[selected]").forEach(t=>{let e=t.getAttribute("value")||t.textContent?.trim();e&&this.#i.add(e);}),this.#h(),this.#s||this.#n(),this.#t.addEventListener("click",this.#d),this.#t.addEventListener("keydown",this.#u),this.#e.addEventListener("keydown",this.#c),this.addEventListener("option-click",this.#p);}#v(){this.#t?.removeEventListener("click",this.#d),this.#t?.removeEventListener("keydown",this.#u),this.#e?.removeEventListener("keydown",this.#c),this.removeEventListener("option-click",this.#p),document.removeEventListener("click",this.#l),document.removeEventListener("keydown",this.#o);}#d=t=>{this.disabled||(t.stopPropagation(),this.open=!this.open);};#u=t=>{this.disabled||["ArrowDown","ArrowUp","Enter"," "].includes(t.key)&&(t.preventDefault(),this.open=true);};#c=t=>{if(this.#a?.handleKeyDown(t),t.key==="Enter"||t.key===" "){let e=this.#e.querySelector("ytz-option:focus");e&&!e.hasAttribute("disabled")&&(t.preventDefault(),this.#f(e));}t.key==="Tab"&&(t.preventDefault(),this.open=false,this.#t?.focus());};#p=t=>{if(this.disabled)return;let e=t.detail?.option;e&&!e.hasAttribute("disabled")&&this.#f(e);};#l=t=>{this.contains(t.target)||(this.open=false);};#o=t=>{t.key==="Escape"&&this.open&&(t.preventDefault(),this.open=false,this.#t?.focus());};#f(t){let e=t.getAttribute("value")||t.textContent?.trim();e&&(this.multiple?this.#i.has(e)?this.#i.delete(e):this.#i.add(e):(this.#i.clear(),this.#i.add(e),this.open=false,this.#t?.focus()),this.#h(),this.#s||this.#n(),this.dispatchEvent(new CustomEvent("change",{bubbles:true,detail:{value:this.value,option:t}})));}#h(){this.querySelectorAll("ytz-option").forEach(t=>{let e=t.getAttribute("value")||t.textContent?.trim(),h=this.#i.has(e);t.toggleAttribute("selected",h),t.setAttribute("aria-selected",String(h));});}#n(){if(!this.#t||this.#s)return;let t=this.selectedOptions;t.length===0?this.#t.textContent=this.placeholder:this.multiple?this.#t.textContent=t.map(e=>e.textContent?.trim()).join(", "):this.#t.textContent=t[0]?.textContent?.trim()||this.placeholder;}#b(){this.disabled?(this.#t?.setAttribute("disabled",""),this.#t?.setAttribute("aria-disabled","true")):(this.#t?.removeAttribute("disabled"),this.#t?.removeAttribute("aria-disabled"));}#m(){!this.#e||this.disabled||(this.#t?.setAttribute("aria-expanded","true"),this.#e.hidden=false,this.#A(),setTimeout(()=>document.addEventListener("click",this.#l),0),document.addEventListener("keydown",this.#o),requestAnimationFrame(()=>{let t=this.#e.querySelector("ytz-option[selected]:not([disabled])"),e=this.#e.querySelector("ytz-option:not([disabled])");(t||e)?.focus();}),this.dispatchEvent(new CustomEvent("open",{bubbles:true})));}#y(){this.#e&&(this.#t?.setAttribute("aria-expanded","false"),this.#e.hidden=true,document.removeEventListener("click",this.#l),document.removeEventListener("keydown",this.#o),this.dispatchEvent(new CustomEvent("close",{bubbles:true})));}#A=()=>{if(!this.#t||!this.#e)return;let{x:t,y:e,placement:h}=p(this.#t,this.#e,{placement:"bottom",offset:4});this.#e.style.position="fixed",this.#e.style.left=`${t}px`,this.#e.style.top=`${e}px`,this.#e.style.minWidth=`${this.#t.offsetWidth}px`,this.#e.dataset.placement=h;};show(){this.open=true;}hide(){this.open=false;}toggle(){this.open=!this.open;}clear(){this.#i.clear(),this.#h(),this.#s||this.#n(),this.dispatchEvent(new CustomEvent("clear",{bubbles:true}));}};b("ytz-select",c);export{c as YtzSelect};//# sourceMappingURL=select.js.map
//# sourceMappingURL=select.js.map