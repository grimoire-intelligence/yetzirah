function p(a,t,l={}){let{placement:o="top",offset:h=8}=l,e=a.getBoundingClientRect(),i=t.getBoundingClientRect(),d={width:window.innerWidth,height:window.innerHeight},s,n,r=o;switch(o){case "top":s=e.left+(e.width-i.width)/2,n=e.top-i.height-h;break;case "bottom":s=e.left+(e.width-i.width)/2,n=e.bottom+h;break;case "left":s=e.left-i.width-h,n=e.top+(e.height-i.height)/2;break;case "right":s=e.right+h,n=e.top+(e.height-i.height)/2;break}return o==="top"&&n<0?(n=e.bottom+h,r="bottom"):o==="bottom"&&n+i.height>d.height?(n=e.top-i.height-h,r="top"):o==="left"&&s<0?(s=e.right+h,r="right"):o==="right"&&s+i.width>d.width&&(s=e.left-i.width-h,r="left"),r==="top"||r==="bottom"?s=Math.max(0,Math.min(s,d.width-i.width)):n=Math.max(0,Math.min(n,d.height-i.height)),{x:s,y:n,placement:r}}function u(a,t){customElements.get(a)||customElements.define(a,t);}var f=0,m='a[href], button:not([disabled]), input:not([disabled]), select:not([disabled]), textarea:not([disabled]), [tabindex]:not([tabindex="-1"])',c=class extends HTMLElement{static observedAttributes=["open","placement","offset"];#e=null;#t=null;#s=null;connectedCallback(){this.#a(),this.hasAttribute("open")&&this.#r();}disconnectedCallback(){this.#l();}attributeChangedCallback(t,l,o){this.isConnected&&(t==="open"?o!==null?this.#r():this.#d():this.hasAttribute("open")&&this.#i());}get placement(){return this.getAttribute("placement")||"bottom"}set placement(t){this.setAttribute("placement",t);}get offset(){return parseInt(this.getAttribute("offset")||"8",10)}set offset(t){this.setAttribute("offset",String(t));}get open(){return this.hasAttribute("open")}set open(t){t?this.setAttribute("open",""):this.removeAttribute("open");}#a(){this.#e=this.firstElementChild,this.#t=this.querySelector('[slot="content"]')||this.lastElementChild,!(!this.#e||!this.#t||this.#e===this.#t)&&(this.#s=this.#t.id||`ytz-popover-${++f}`,this.#t.id=this.#s,this.#e.setAttribute("aria-haspopup","dialog"),this.#e.setAttribute("aria-expanded","false"),this.#e.setAttribute("aria-controls",this.#s),this.#t.hidden=true,this.#e.addEventListener("click",this.#h));}#l(){this.#e?.removeEventListener("click",this.#h),document.removeEventListener("click",this.#n),document.removeEventListener("keydown",this.#o),window.removeEventListener("scroll",this.#i,{capture:true}),window.removeEventListener("resize",this.#i);}#h=t=>{t.stopPropagation(),this.open=!this.open;};#n=t=>{!this.#t?.contains(t.target)&&!this.#e?.contains(t.target)&&(this.open=false);};#o=t=>{t.key==="Escape"&&this.open&&(t.preventDefault(),this.open=false,this.#e?.focus());};#r(){this.#t&&(this.#e?.setAttribute("aria-expanded","true"),this.#t.hidden=false,this.#i(),setTimeout(()=>{document.addEventListener("click",this.#n);},0),document.addEventListener("keydown",this.#o),window.addEventListener("scroll",this.#i,{passive:true,capture:true}),window.addEventListener("resize",this.#i,{passive:true}),requestAnimationFrame(()=>{let t=this.#t?.querySelector(m);t&&t.focus();}),this.dispatchEvent(new CustomEvent("show",{bubbles:true})));}#d(){this.#t&&(this.#e?.setAttribute("aria-expanded","false"),this.#t.hidden=true,document.removeEventListener("click",this.#n),document.removeEventListener("keydown",this.#o),window.removeEventListener("scroll",this.#i,{capture:true}),window.removeEventListener("resize",this.#i),this.dispatchEvent(new CustomEvent("hide",{bubbles:true})));}#i=()=>{if(!this.#e||!this.#t)return;let{x:t,y:l,placement:o}=p(this.#e,this.#t,{placement:this.placement,offset:this.offset});this.#t.style.position="fixed",this.#t.style.left=`${t}px`,this.#t.style.top=`${l}px`,this.#t.dataset.placement=o;};show(){this.open=true;}hide(){this.open=false;}toggle(){this.open=!this.open;}};u("ytz-popover",c);export{c as YtzPopover};//# sourceMappingURL=popover.js.map
//# sourceMappingURL=popover.js.map