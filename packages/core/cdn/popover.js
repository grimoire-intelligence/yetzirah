function p(c,t,a={}){let{placement:h="top",offset:o=8}=a,e=c.getBoundingClientRect(),i=t.getBoundingClientRect(),l={width:window.innerWidth,height:window.innerHeight},s,n,r=h;switch(h){case "top":s=e.left+(e.width-i.width)/2,n=e.top-i.height-o;break;case "bottom":s=e.left+(e.width-i.width)/2,n=e.bottom+o;break;case "left":s=e.left-i.width-o,n=e.top+(e.height-i.height)/2;break;case "right":s=e.right+o,n=e.top+(e.height-i.height)/2;break}return h==="top"&&n<0?(n=e.bottom+o,r="bottom"):h==="bottom"&&n+i.height>l.height?(n=e.top-i.height-o,r="top"):h==="left"&&s<0?(s=e.right+o,r="right"):h==="right"&&s+i.width>l.width&&(s=e.left-i.width-o,r="left"),r==="top"||r==="bottom"?s=Math.max(0,Math.min(s,l.width-i.width)):n=Math.max(0,Math.min(n,l.height-i.height)),{x:s,y:n,placement:r}}var u=0,f='a[href], button:not([disabled]), input:not([disabled]), select:not([disabled]), textarea:not([disabled]), [tabindex]:not([tabindex="-1"])',d=class extends HTMLElement{static observedAttributes=["open","placement","offset"];#e=null;#t=null;#s=null;connectedCallback(){this.#a(),this.hasAttribute("open")&&this.#r();}disconnectedCallback(){this.#l();}attributeChangedCallback(t,a,h){this.isConnected&&(t==="open"?h!==null?this.#r():this.#d():this.hasAttribute("open")&&this.#i());}get placement(){return this.getAttribute("placement")||"bottom"}set placement(t){this.setAttribute("placement",t);}get offset(){return parseInt(this.getAttribute("offset")||"8",10)}set offset(t){this.setAttribute("offset",String(t));}get open(){return this.hasAttribute("open")}set open(t){t?this.setAttribute("open",""):this.removeAttribute("open");}#a(){this.#e=this.firstElementChild,this.#t=this.querySelector('[slot="content"]')||this.lastElementChild,!(!this.#e||!this.#t||this.#e===this.#t)&&(this.#s=this.#t.id||`ytz-popover-${++u}`,this.#t.id=this.#s,this.#e.setAttribute("aria-haspopup","dialog"),this.#e.setAttribute("aria-expanded","false"),this.#e.setAttribute("aria-controls",this.#s),this.#t.hidden=true,this.#e.addEventListener("click",this.#o));}#l(){this.#e?.removeEventListener("click",this.#o),document.removeEventListener("click",this.#n),document.removeEventListener("keydown",this.#h),window.removeEventListener("scroll",this.#i,{capture:true}),window.removeEventListener("resize",this.#i);}#o=t=>{t.stopPropagation(),this.open=!this.open;};#n=t=>{!this.#t?.contains(t.target)&&!this.#e?.contains(t.target)&&(this.open=false);};#h=t=>{t.key==="Escape"&&this.open&&(t.preventDefault(),this.open=false,this.#e?.focus());};#r(){this.#t&&(this.#e?.setAttribute("aria-expanded","true"),this.#t.hidden=false,this.#i(),setTimeout(()=>{document.addEventListener("click",this.#n);},0),document.addEventListener("keydown",this.#h),window.addEventListener("scroll",this.#i,{passive:true,capture:true}),window.addEventListener("resize",this.#i,{passive:true}),requestAnimationFrame(()=>{let t=this.#t?.querySelector(f);t&&t.focus();}),this.dispatchEvent(new CustomEvent("show",{bubbles:true})));}#d(){this.#t&&(this.#e?.setAttribute("aria-expanded","false"),this.#t.hidden=true,document.removeEventListener("click",this.#n),document.removeEventListener("keydown",this.#h),window.removeEventListener("scroll",this.#i,{capture:true}),window.removeEventListener("resize",this.#i),this.dispatchEvent(new CustomEvent("hide",{bubbles:true})));}#i=()=>{if(!this.#e||!this.#t)return;let{x:t,y:a,placement:h}=p(this.#e,this.#t,{placement:this.placement,offset:this.offset});this.#t.style.position="fixed",this.#t.style.left=`${t}px`,this.#t.style.top=`${a}px`,this.#t.dataset.placement=h;};show(){this.open=true;}hide(){this.open=false;}toggle(){this.open=!this.open;}};customElements.define("ytz-popover",d);export{d as YtzPopover};//# sourceMappingURL=popover.js.map
//# sourceMappingURL=popover.js.map