function c(u,t,i={}){let{placement:n="top",offset:o=8}=i,e=u.getBoundingClientRect(),h=t.getBoundingClientRect(),d={width:window.innerWidth,height:window.innerHeight},r,s,l=n;switch(n){case "top":r=e.left+(e.width-h.width)/2,s=e.top-h.height-o;break;case "bottom":r=e.left+(e.width-h.width)/2,s=e.bottom+o;break;case "left":r=e.left-h.width-o,s=e.top+(e.height-h.height)/2;break;case "right":r=e.right+o,s=e.top+(e.height-h.height)/2;break}return n==="top"&&s<0?(s=e.bottom+o,l="bottom"):n==="bottom"&&s+h.height>d.height?(s=e.top-h.height-o,l="top"):n==="left"&&r<0?(r=e.right+o,l="right"):n==="right"&&r+h.width>d.width&&(r=e.left-h.width-o,l="left"),l==="top"||l==="bottom"?r=Math.max(0,Math.min(r,d.width-h.width)):s=Math.max(0,Math.min(s,d.height-h.height)),{x:r,y:s,placement:l}}function f(u,t={}){let{orientation:i="horizontal",wrap:n=true,autoActivate:o=true,onActivate:e}=t,h=i==="horizontal"?"ArrowLeft":"ArrowUp",d=i==="horizontal"?"ArrowRight":"ArrowDown";return {handleKeyDown(r){let s=u(),l=s.indexOf(document.activeElement);if(l===-1)return;let a=l;if(r.key===h)a=l-1,a<0&&(a=n?s.length-1:0);else if(r.key===d)a=l+1,a>=s.length&&(a=n?0:s.length-1);else if(r.key==="Home")a=0;else if(r.key==="End")a=s.length-1;else return;r.preventDefault(),s[a].focus(),o&&e&&e(s[a]);}}}function b(u,t,i={}){let{ignore:n}=i,o=e=>{u.contains(e.target)||n&&n.contains(e.target)||t(e);};return document.addEventListener("click",o,true),{destroy(){document.removeEventListener("click",o,true);}}}var v=0,p=class extends HTMLElement{static observedAttributes=["open","placement"];#e=null;#t=null;#n=null;#r=null;#i=null;#o=0;connectedCallback(){this.#a();}disconnectedCallback(){this.#u();}attributeChangedCallback(t,i,n){this.isConnected&&t==="open"&&(n!==null?this.#d():this.#c());}get open(){return this.hasAttribute("open")}set open(t){t?this.setAttribute("open",""):this.removeAttribute("open");}get placement(){return this.getAttribute("placement")||"bottom-start"}set placement(t){t?this.setAttribute("placement",t):this.removeAttribute("placement");}#a(){if(this.#e=this.querySelector('[slot="trigger"]'),!this.#e)return;this.#n=`ytz-menu-${++v}`,this.#t=document.createElement("div"),this.#t.setAttribute("role","menu"),this.#t.id=this.#n,this.#t.hidden=true,[...this.querySelectorAll("ytz-menuitem")].forEach(i=>this.#t.appendChild(i)),this.appendChild(this.#t),this.#e.setAttribute("aria-haspopup","menu"),this.#e.setAttribute("aria-controls",this.#n),this.#e.setAttribute("aria-expanded","false"),this.#r=f(()=>[...this.#t.querySelectorAll("ytz-menuitem:not([disabled])")],{orientation:"vertical",wrap:true,autoActivate:false}),this.#e.addEventListener("click",this.#h),this.addEventListener("keydown",this.#l);}#u(){this.#e?.removeEventListener("click",this.#h),this.removeEventListener("keydown",this.#l),this.#i?.destroy();}#h=()=>{this.open=!this.open;};#l=t=>{if(this.open){if(t.key==="Escape"){t.preventDefault(),this.open=false,this.#e?.focus();return}if(this.#r?.handleKeyDown(t),t.key==="Enter"||t.key===" "){let i=this.#t?.querySelector("ytz-menuitem:focus");i&&!i.hasAttribute("disabled")&&(t.preventDefault(),i.click());}}};#d(){if(!this.#e||!this.#t)return;if(performance.now()-this.#o<10){this.removeAttribute("open");return}this.#t.style.position="fixed",this.#t.style.visibility="hidden",this.#t.hidden=false,this.#t.offsetHeight;let t=this.placement.split("-")[0]||"bottom",{x:i,y:n}=c(this.#e,this.#t,{placement:t,offset:4});this.#t.style.left=`${i}px`,this.#t.style.top=`${n}px`,this.#t.style.visibility="",this.#e.setAttribute("aria-expanded","true"),this.#t.querySelector("ytz-menuitem:not([disabled])")?.focus(),setTimeout(()=>{this.open&&(this.#i=b(this.#t,()=>{this.open=false;},{ignore:this.#e}));},0),window.addEventListener("scroll",this.#s,{passive:true,capture:true}),window.addEventListener("resize",this.#s,{passive:true}),this.dispatchEvent(new CustomEvent("open",{bubbles:true}));}#c(){!this.#e||!this.#t||(this.#o=performance.now(),this.#t.hidden=true,this.#e.setAttribute("aria-expanded","false"),this.#i?.destroy(),this.#i=null,window.removeEventListener("scroll",this.#s,{capture:true}),window.removeEventListener("resize",this.#s),this.dispatchEvent(new CustomEvent("close",{bubbles:true})));}#s=()=>{if(!this.#e||!this.#t)return;let t=this.placement.split("-")[0]||"bottom",{x:i,y:n}=c(this.#e,this.#t,{placement:t,offset:4});this.#t.style.position="fixed",this.#t.style.left=`${i}px`,this.#t.style.top=`${n}px`;};show(){this.open=true;}hide(){this.open=false;}toggle(){this.open=!this.open;}},m=class extends HTMLElement{connectedCallback(){this.setAttribute("role","menuitem"),!this.hasAttribute("tabindex")&&!this.hasAttribute("disabled")&&this.setAttribute("tabindex","-1"),this.hasAttribute("disabled")&&this.setAttribute("aria-disabled","true"),this.addEventListener("click",this.#e);}disconnectedCallback(){this.removeEventListener("click",this.#e);}#e=t=>{if(this.hasAttribute("disabled")){t.preventDefault(),t.stopPropagation();return}let i=this.closest("ytz-menu");i&&(this.dispatchEvent(new CustomEvent("select",{bubbles:true,detail:{value:this.getAttribute("value")||this.textContent?.trim()}})),i.open=false);};get disabled(){return this.hasAttribute("disabled")}set disabled(t){t?(this.setAttribute("disabled",""),this.setAttribute("aria-disabled","true"),this.removeAttribute("tabindex")):(this.removeAttribute("disabled"),this.removeAttribute("aria-disabled"),this.setAttribute("tabindex","-1"));}get value(){return this.getAttribute("value")}set value(t){t?this.setAttribute("value",t):this.removeAttribute("value");}};customElements.define("ytz-menu",p);customElements.define("ytz-menuitem",m);export{p as YtzMenu,m as YtzMenuItem};//# sourceMappingURL=menu.js.map
//# sourceMappingURL=menu.js.map