{"version":3,"sources":["../src/utils/key-nav.js","../src/utils/register.js","../src/tabs.js"],"names":["createKeyNav","getItems","options","orientation","wrap","autoActivate","onActivate","prevKey","nextKey","e","items","currentIndex","newIndex","register","name","constructor","tabId","YtzTabs","#keyNav","#setupKeyNav","firstTab","#updateSelection","oldVal","newVal","tab","panel","#handleKeyDown","value","isSelected","v","YtzTab","panelId","#handleClick","tabs","YtzTabPanel","#linkToTab"],"mappings":"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","file":"tabs.js","sourcesContent":["/**\r\n * Keyboard navigation utility for arrow key navigation.\r\n * @module @grimoire/yetzirah-core/utils/key-nav\r\n * @internal Not exported from package\r\n */\r\n\r\n/**\r\n * Creates keyboard navigation for a set of elements.\r\n * @param {() => HTMLElement[]} getItems - Function returning navigable elements\r\n * @param {Object} options\r\n * @param {'horizontal'|'vertical'} [options.orientation='horizontal']\r\n * @param {boolean} [options.wrap=true]\r\n * @param {boolean} [options.autoActivate=true]\r\n * @param {(item: HTMLElement) => void} [options.onActivate]\r\n * @returns {{ handleKeyDown: (e: KeyboardEvent) => void }}\r\n */\r\nexport function createKeyNav(getItems, options = {}) {\r\n  const { orientation = 'horizontal', wrap = true, autoActivate = true, onActivate } = options\r\n  const prevKey = orientation === 'horizontal' ? 'ArrowLeft' : 'ArrowUp'\r\n  const nextKey = orientation === 'horizontal' ? 'ArrowRight' : 'ArrowDown'\r\n\r\n  return {\r\n    handleKeyDown(e) {\r\n      const items = getItems()\r\n      const currentIndex = items.indexOf(document.activeElement)\r\n      if (currentIndex === -1) return\r\n\r\n      let newIndex = currentIndex\r\n      if (e.key === prevKey) {\r\n        newIndex = currentIndex - 1\r\n        if (newIndex < 0) newIndex = wrap ? items.length - 1 : 0\r\n      } else if (e.key === nextKey) {\r\n        newIndex = currentIndex + 1\r\n        if (newIndex >= items.length) newIndex = wrap ? 0 : items.length - 1\r\n      } else if (e.key === 'Home') {\r\n        newIndex = 0\r\n      } else if (e.key === 'End') {\r\n        newIndex = items.length - 1\r\n      } else {\r\n        return\r\n      }\r\n\r\n      e.preventDefault()\r\n      items[newIndex].focus()\r\n      if (autoActivate && onActivate) onActivate(items[newIndex])\r\n    }\r\n  }\r\n}\r\n","/**\r\n * Idempotent custom element registration utility.\r\n * Prevents duplicate registration errors when scripts load multiple times.\r\n *\r\n * @module @grimoire/yetzirah-core/utils/register\r\n * @internal Not exported from package\r\n */\r\n\r\n/**\r\n * Register a custom element if not already registered.\r\n * Safe to call multiple times with the same name.\r\n *\r\n * @param {string} name - Custom element tag name (e.g., 'ytz-button')\r\n * @param {CustomElementConstructor} constructor - The element class\r\n */\r\nexport function register(name, constructor) {\r\n  if (!customElements.get(name)) {\r\n    customElements.define(name, constructor)\r\n  }\r\n}\r\n","/**\r\n * ytz-tabs - Tabbed interface Web Components.\r\n * @module @grimoire/yetzirah-core/tabs\r\n * @example\r\n * <ytz-tabs>\r\n *   <ytz-tab panel=\"tab1\">Account</ytz-tab>\r\n *   <ytz-tabpanel id=\"tab1\">Account content</ytz-tabpanel>\r\n * </ytz-tabs>\r\n */\r\n\r\nimport { createKeyNav } from './utils/key-nav.js'\r\nimport { register } from './utils/register.js'\r\n\r\nlet tabId = 0\r\n\r\n/** @class YtzTabs */\r\nclass YtzTabs extends HTMLElement {\r\n  static observedAttributes = ['value', 'orientation']\r\n  #keyNav = null\r\n\r\n  connectedCallback() {\r\n    this.setAttribute('role', 'tablist')\r\n    this.#setupKeyNav()\r\n    if (!this.hasAttribute('value')) {\r\n      const firstTab = this.querySelector('ytz-tab')\r\n      if (firstTab?.getAttribute('panel')) {\r\n        this.setAttribute('value', firstTab.getAttribute('panel'))\r\n      }\r\n    }\r\n    this.#updateSelection()\r\n  }\r\n\r\n  attributeChangedCallback(name, oldVal, newVal) {\r\n    if (!this.isConnected) return\r\n    if (name === 'value' && oldVal !== newVal) {\r\n      this.#updateSelection()\r\n      if (oldVal !== null) {\r\n        this.dispatchEvent(new CustomEvent('change', { bubbles: true, detail: { value: newVal } }))\r\n      }\r\n    }\r\n    if (name === 'orientation') this.#setupKeyNav()\r\n  }\r\n\r\n  #setupKeyNav() {\r\n    const orientation = this.getAttribute('orientation') === 'vertical' ? 'vertical' : 'horizontal'\r\n    this.#keyNav = createKeyNav(\r\n      () => [...this.querySelectorAll('ytz-tab')],\r\n      {\r\n        orientation,\r\n        wrap: true,\r\n        autoActivate: true,\r\n        onActivate: (tab) => {\r\n          const panel = tab.getAttribute('panel')\r\n          if (panel) this.value = panel\r\n        }\r\n      }\r\n    )\r\n    this.addEventListener('keydown', this.#handleKeyDown)\r\n  }\r\n\r\n  #handleKeyDown = (e) => this.#keyNav?.handleKeyDown(e)\r\n\r\n  #updateSelection() {\r\n    const value = this.getAttribute('value')\r\n    this.querySelectorAll('ytz-tab').forEach((tab) => {\r\n      const isSelected = tab.getAttribute('panel') === value\r\n      tab.setAttribute('aria-selected', String(isSelected))\r\n      tab.setAttribute('tabindex', isSelected ? '0' : '-1')\r\n    })\r\n    this.querySelectorAll('ytz-tabpanel').forEach((panel) => {\r\n      panel.hidden = panel.id !== value\r\n    })\r\n  }\r\n\r\n  get value() { return this.getAttribute('value') }\r\n  set value(v) { v ? this.setAttribute('value', v) : this.removeAttribute('value') }\r\n\r\n  get orientation() {\r\n    return this.getAttribute('orientation') === 'vertical' ? 'vertical' : 'horizontal'\r\n  }\r\n  set orientation(v) { this.setAttribute('orientation', v) }\r\n}\r\n\r\n/** @class YtzTab */\r\nclass YtzTab extends HTMLElement {\r\n  connectedCallback() {\r\n    this.setAttribute('role', 'tab')\r\n    if (!this.hasAttribute('tabindex')) this.setAttribute('tabindex', '-1')\r\n    if (!this.id) this.id = `ytz-tab-${++tabId}`\r\n    const panelId = this.getAttribute('panel')\r\n    if (panelId) this.setAttribute('aria-controls', panelId)\r\n    this.addEventListener('click', this.#handleClick)\r\n  }\r\n\r\n  disconnectedCallback() { this.removeEventListener('click', this.#handleClick) }\r\n\r\n  #handleClick = () => {\r\n    const tabs = this.closest('ytz-tabs')\r\n    const panel = this.getAttribute('panel')\r\n    if (tabs && panel) tabs.value = panel\r\n  }\r\n\r\n  get panel() { return this.getAttribute('panel') }\r\n  set panel(v) {\r\n    if (v) {\r\n      this.setAttribute('panel', v)\r\n      this.setAttribute('aria-controls', v)\r\n    } else {\r\n      this.removeAttribute('panel')\r\n      this.removeAttribute('aria-controls')\r\n    }\r\n  }\r\n}\r\n\r\n/** @class YtzTabPanel */\r\nclass YtzTabPanel extends HTMLElement {\r\n  connectedCallback() {\r\n    this.setAttribute('role', 'tabpanel')\r\n    const tabs = this.closest('ytz-tabs')\r\n    if (tabs) {\r\n      this.hidden = this.id !== tabs.getAttribute('value')\r\n    } else {\r\n      this.hidden = true\r\n    }\r\n    this.#linkToTab()\r\n  }\r\n\r\n  #linkToTab() {\r\n    const tabs = this.closest('ytz-tabs')\r\n    if (!tabs || !this.id) return\r\n    const tab = tabs.querySelector(`ytz-tab[panel=\"${this.id}\"]`)\r\n    if (tab) {\r\n      if (!tab.id) tab.id = `ytz-tab-${++tabId}`\r\n      this.setAttribute('aria-labelledby', tab.id)\r\n    }\r\n  }\r\n}\r\n\r\nregister('ytz-tabs', YtzTabs)\r\nregister('ytz-tab', YtzTab)\r\nregister('ytz-tabpanel', YtzTabPanel)\r\n\r\nexport { YtzTabs, YtzTab, YtzTabPanel }\r\n"]}