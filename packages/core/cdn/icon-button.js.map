{"version":3,"sources":["../src/utils/register.js","../src/icon-button.js"],"names":["register","name","constructor","DEFAULTS","YtzIconButton","#tooltipEl","#render","#checkAccessibility","#removeTooltip","#showTooltip","#hideTooltip","oldVal","newVal","userClass","button","isNew","label","attr","#setupTooltip","rect","value"],"mappings":"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","file":"icon-button.js","sourcesContent":["/**\r\n * Idempotent custom element registration utility.\r\n * Prevents duplicate registration errors when scripts load multiple times.\r\n *\r\n * @module @grimoire/yetzirah-core/utils/register\r\n * @internal Not exported from package\r\n */\r\n\r\n/**\r\n * Register a custom element if not already registered.\r\n * Safe to call multiple times with the same name.\r\n *\r\n * @param {string} name - Custom element tag name (e.g., 'ytz-button')\r\n * @param {CustomElementConstructor} constructor - The element class\r\n */\r\nexport function register(name, constructor) {\r\n  if (!customElements.get(name)) {\r\n    customElements.define(name, constructor)\r\n  }\r\n}\r\n","/**\r\n * ytz-icon-button - Icon button Web Component.\r\n * A button variant requiring aria-label for accessibility.\r\n *\r\n * @module @grimoire/yetzirah-core/icon-button\r\n * @example\r\n * <ytz-icon-button aria-label=\"Close\">\r\n *   <svg>...</svg>\r\n * </ytz-icon-button>\r\n *\r\n * @example\r\n * // With tooltip integration\r\n * <ytz-icon-button aria-label=\"Settings\" tooltip>\r\n *   <svg>...</svg>\r\n * </ytz-icon-button>\r\n *\r\n * @example\r\n * // Disabled\r\n * <ytz-icon-button aria-label=\"Delete\" disabled>\r\n *   <svg>...</svg>\r\n * </ytz-icon-button>\r\n */\r\n\r\nimport { register } from './utils/register.js'\r\n\r\n/** @type {string} Default classes for icon button */\r\nconst DEFAULTS = 'pointer bn bg-transparent pa0 dib'\r\n\r\n/**\r\n * @class YtzIconButton\r\n * @extends HTMLElement\r\n */\r\nclass YtzIconButton extends HTMLElement {\r\n  static observedAttributes = ['disabled', 'aria-label', 'tooltip', 'class']\r\n\r\n  /** @type {HTMLElement|null} */\r\n  #tooltipEl = null\r\n\r\n  connectedCallback() {\r\n    this.#render()\r\n    this.#checkAccessibility()\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    this.#removeTooltip()\r\n    this.removeEventListener('mouseenter', this.#showTooltip)\r\n    this.removeEventListener('mouseleave', this.#hideTooltip)\r\n    this.removeEventListener('focus', this.#showTooltip)\r\n    this.removeEventListener('blur', this.#hideTooltip)\r\n  }\r\n\r\n  attributeChangedCallback(name, oldVal, newVal) {\r\n    if (this.isConnected) {\r\n      this.#render()\r\n      if (name === 'aria-label') {\r\n        this.#checkAccessibility()\r\n      }\r\n    }\r\n  }\r\n\r\n  #checkAccessibility() {\r\n    if (!this.hasAttribute('aria-label')) {\r\n      console.warn('ytz-icon-button: aria-label is required for accessibility')\r\n    }\r\n  }\r\n\r\n  #render() {\r\n    const userClass = this.getAttribute('class') || ''\r\n    const button = this.querySelector('button.ytz-icon-button-inner') || document.createElement('button')\r\n    const isNew = !button.parentNode\r\n\r\n    button.type = 'button'\r\n    button.className = 'ytz-icon-button-inner ' + DEFAULTS + (userClass ? ' ' + userClass : '')\r\n    button.disabled = this.hasAttribute('disabled')\r\n\r\n    // Copy aria-label to inner button\r\n    const label = this.getAttribute('aria-label')\r\n    if (label) {\r\n      button.setAttribute('aria-label', label)\r\n    }\r\n\r\n    // Copy aria-* and data-* attributes\r\n    for (const attr of this.attributes) {\r\n      if ((attr.name.startsWith('aria-') || attr.name.startsWith('data-')) && attr.name !== 'aria-label') {\r\n        button.setAttribute(attr.name, attr.value)\r\n      }\r\n    }\r\n\r\n    if (isNew) {\r\n      // Move icon content into button\r\n      while (this.firstChild && this.firstChild !== button) {\r\n        button.appendChild(this.firstChild)\r\n      }\r\n      this.appendChild(button)\r\n    }\r\n\r\n    // Setup tooltip if requested\r\n    this.#setupTooltip()\r\n  }\r\n\r\n  #setupTooltip() {\r\n    // Remove old listeners\r\n    this.removeEventListener('mouseenter', this.#showTooltip)\r\n    this.removeEventListener('mouseleave', this.#hideTooltip)\r\n    this.removeEventListener('focus', this.#showTooltip)\r\n    this.removeEventListener('blur', this.#hideTooltip)\r\n\r\n    if (this.hasAttribute('tooltip')) {\r\n      this.addEventListener('mouseenter', this.#showTooltip)\r\n      this.addEventListener('mouseleave', this.#hideTooltip)\r\n      this.addEventListener('focus', this.#showTooltip)\r\n      this.addEventListener('blur', this.#hideTooltip)\r\n    }\r\n  }\r\n\r\n  #showTooltip = () => {\r\n    const label = this.getAttribute('aria-label')\r\n    if (!label) return\r\n\r\n    this.#tooltipEl = document.createElement('div')\r\n    this.#tooltipEl.className = 'ytz-icon-button-tooltip'\r\n    this.#tooltipEl.textContent = label\r\n    this.#tooltipEl.setAttribute('role', 'tooltip')\r\n\r\n    // Position tooltip below button\r\n    // Use inner button for rect since parent may have display:contents\r\n    const button = this.querySelector('button.ytz-icon-button-inner')\r\n    const rect = (button || this).getBoundingClientRect()\r\n    this.#tooltipEl.style.cssText = `\r\n      position: fixed;\r\n      left: ${rect.left + rect.width / 2}px;\r\n      top: ${rect.bottom + 4}px;\r\n      transform: translateX(-50%);\r\n      z-index: 9999;\r\n    `\r\n\r\n    document.body.appendChild(this.#tooltipEl)\r\n  }\r\n\r\n  #hideTooltip = () => {\r\n    this.#removeTooltip()\r\n  }\r\n\r\n  #removeTooltip() {\r\n    if (this.#tooltipEl) {\r\n      this.#tooltipEl.remove()\r\n      this.#tooltipEl = null\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get/set the disabled state.\r\n   * @type {boolean}\r\n   */\r\n  get disabled() {\r\n    return this.hasAttribute('disabled')\r\n  }\r\n\r\n  set disabled(value) {\r\n    if (value) {\r\n      this.setAttribute('disabled', '')\r\n    } else {\r\n      this.removeAttribute('disabled')\r\n    }\r\n  }\r\n}\r\n\r\nregister('ytz-icon-button', YtzIconButton)\r\n\r\nexport { YtzIconButton }\r\n"]}