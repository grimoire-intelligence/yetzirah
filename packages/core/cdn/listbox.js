function h(o,t={}){let{orientation:e="horizontal",wrap:s=true,autoActivate:d=true,onActivate:u}=t,c=e==="horizontal"?"ArrowLeft":"ArrowUp",b=e==="horizontal"?"ArrowRight":"ArrowDown";return {handleKeyDown(r){let l=o(),n=l.indexOf(document.activeElement);if(n===-1)return;let i=n;if(r.key===c)i=n-1,i<0&&(i=s?l.length-1:0);else if(r.key===b)i=n+1,i>=l.length&&(i=s?0:l.length-1);else if(r.key==="Home")i=0;else if(r.key==="End")i=l.length-1;else return;r.preventDefault(),l[i].focus(),d&&u&&u(l[i]);}}}var f=0,a=class extends HTMLElement{static observedAttributes=["multiple","disabled"];#i=null;#t=new Set;#s=null;connectedCallback(){this.#o();}disconnectedCallback(){this.#u();}attributeChangedCallback(t,e,s){this.isConnected&&(t==="multiple"&&this.setAttribute("aria-multiselectable",s!==null?"true":"false"),t==="disabled"&&this.#h());}get multiple(){return this.hasAttribute("multiple")}set multiple(t){t?this.setAttribute("multiple",""):this.removeAttribute("multiple");}get disabled(){return this.hasAttribute("disabled")}set disabled(t){t?this.setAttribute("disabled",""):this.removeAttribute("disabled");}get value(){return this.multiple?[...this.#t]:[...this.#t][0]||""}set value(t){this.#t.clear(),Array.isArray(t)?t.forEach(e=>this.#t.add(e)):t&&this.#t.add(t),this.#e();}get options(){return [...this.querySelectorAll("ytz-option")]}get selectedOptions(){return [...this.querySelectorAll("ytz-option[selected]")]}#o(){this.#s=`ytz-listbox-${++f}`,this.id||(this.id=this.#s),this.setAttribute("role","listbox"),this.multiple&&this.setAttribute("aria-multiselectable","true"),this.hasAttribute("tabindex")||this.setAttribute("tabindex","0"),this.#i=h(()=>[...this.querySelectorAll("ytz-option:not([disabled])")],{orientation:"vertical",wrap:true,autoActivate:false}),this.addEventListener("keydown",this.#r),this.addEventListener("option-click",this.#n),this.addEventListener("focus",this.#l),this.querySelectorAll("ytz-option[selected]").forEach(t=>{let e=t.getAttribute("value")||t.textContent?.trim();e&&this.#t.add(e);}),this.#e();}#u(){this.removeEventListener("keydown",this.#r),this.removeEventListener("option-click",this.#n),this.removeEventListener("focus",this.#l);}#l=()=>{let t=this.querySelector("ytz-option[selected]:not([disabled])"),e=this.querySelector("ytz-option:not([disabled])");(t||e)?.focus();};#r=t=>{if(!this.disabled&&(this.#i?.handleKeyDown(t),t.key==="Enter"||t.key===" ")){let e=this.querySelector("ytz-option:focus");e&&!e.hasAttribute("disabled")&&(t.preventDefault(),this.#a(e));}};#n=t=>{if(this.disabled)return;let e=t.detail?.option;e&&!e.hasAttribute("disabled")&&this.#a(e);};#a(t){let e=t.getAttribute("value")||t.textContent?.trim();e&&(this.multiple?this.#t.has(e)?this.#t.delete(e):this.#t.add(e):(this.#t.clear(),this.#t.add(e)),this.#e(),this.dispatchEvent(new CustomEvent("change",{bubbles:true,detail:{value:this.value,option:t}})));}#e(){this.querySelectorAll("ytz-option").forEach(t=>{let e=t.getAttribute("value")||t.textContent?.trim(),s=this.#t.has(e);t.toggleAttribute("selected",s),t.setAttribute("aria-selected",String(s));});}#h(){this.disabled?(this.setAttribute("aria-disabled","true"),this.removeAttribute("tabindex")):(this.removeAttribute("aria-disabled"),this.setAttribute("tabindex","0"));}clear(){this.#t.clear(),this.#e(),this.dispatchEvent(new CustomEvent("clear",{bubbles:true}));}selectAll(){this.multiple&&(this.querySelectorAll("ytz-option:not([disabled])").forEach(t=>{let e=t.getAttribute("value")||t.textContent?.trim();e&&this.#t.add(e);}),this.#e());}};customElements.define("ytz-listbox",a);export{a as YtzListbox};//# sourceMappingURL=listbox.js.map
//# sourceMappingURL=listbox.js.map