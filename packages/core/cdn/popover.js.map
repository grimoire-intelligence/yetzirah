{"version":3,"sources":["../src/utils/position.js","../src/utils/register.js","../src/popover.js"],"names":["position","anchor","floating","options","placement","offset","anchorRect","floatingRect","viewport","x","y","finalPlacement","register","name","constructor","popoverId","FOCUSABLE","YtzPopover","#trigger","#content","#contentId","#setup","#show","#cleanup","oldVal","newVal","#hide","#updatePosition","value","#handleTriggerClick","#handleOutsideClick","#handleEscape","e","focusable"],"mappings":"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","file":"popover.js","sourcesContent":["/**\r\n * Position utility for tooltips, menus, popovers.\r\n * Places an element relative to an anchor with flip/shift logic.\r\n *\r\n * @module @grimoire/yetzirah-core/utils/position\r\n * @internal Not exported from package\r\n *\r\n * Limitations (by design):\r\n * - Does not handle nested scroll containers\r\n * - Does not support virtual elements\r\n * - No middleware system\r\n */\r\n\r\n/**\r\n * Position a floating element relative to an anchor.\r\n *\r\n * @param {HTMLElement} anchor - Element to position relative to\r\n * @param {HTMLElement} floating - Element to position\r\n * @param {Object} [options] - Positioning options\r\n * @param {'top'|'bottom'|'left'|'right'} [options.placement='top'] - Preferred placement\r\n * @param {number} [options.offset=8] - Gap between anchor and floating element\r\n * @returns {{ x: number, y: number, placement: string }}\r\n */\r\nexport function position(anchor, floating, options = {}) {\r\n  const { placement = 'top', offset = 8 } = options\r\n\r\n  const anchorRect = anchor.getBoundingClientRect()\r\n  const floatingRect = floating.getBoundingClientRect()\r\n  const viewport = { width: window.innerWidth, height: window.innerHeight }\r\n\r\n  let x, y\r\n  let finalPlacement = placement\r\n\r\n  // Calculate position based on placement\r\n  switch (placement) {\r\n    case 'top':\r\n      x = anchorRect.left + (anchorRect.width - floatingRect.width) / 2\r\n      y = anchorRect.top - floatingRect.height - offset\r\n      break\r\n    case 'bottom':\r\n      x = anchorRect.left + (anchorRect.width - floatingRect.width) / 2\r\n      y = anchorRect.bottom + offset\r\n      break\r\n    case 'left':\r\n      x = anchorRect.left - floatingRect.width - offset\r\n      y = anchorRect.top + (anchorRect.height - floatingRect.height) / 2\r\n      break\r\n    case 'right':\r\n      x = anchorRect.right + offset\r\n      y = anchorRect.top + (anchorRect.height - floatingRect.height) / 2\r\n      break\r\n  }\r\n\r\n  // Flip if outside viewport\r\n  if (placement === 'top' && y < 0) {\r\n    y = anchorRect.bottom + offset\r\n    finalPlacement = 'bottom'\r\n  } else if (placement === 'bottom' && y + floatingRect.height > viewport.height) {\r\n    y = anchorRect.top - floatingRect.height - offset\r\n    finalPlacement = 'top'\r\n  } else if (placement === 'left' && x < 0) {\r\n    x = anchorRect.right + offset\r\n    finalPlacement = 'right'\r\n  } else if (placement === 'right' && x + floatingRect.width > viewport.width) {\r\n    x = anchorRect.left - floatingRect.width - offset\r\n    finalPlacement = 'left'\r\n  }\r\n\r\n  // Shift to stay in viewport\r\n  if (finalPlacement === 'top' || finalPlacement === 'bottom') {\r\n    x = Math.max(0, Math.min(x, viewport.width - floatingRect.width))\r\n  } else {\r\n    y = Math.max(0, Math.min(y, viewport.height - floatingRect.height))\r\n  }\r\n\r\n  return { x, y, placement: finalPlacement }\r\n}\r\n","/**\r\n * Idempotent custom element registration utility.\r\n * Prevents duplicate registration errors when scripts load multiple times.\r\n *\r\n * @module @grimoire/yetzirah-core/utils/register\r\n * @internal Not exported from package\r\n */\r\n\r\n/**\r\n * Register a custom element if not already registered.\r\n * Safe to call multiple times with the same name.\r\n *\r\n * @param {string} name - Custom element tag name (e.g., 'ytz-button')\r\n * @param {CustomElementConstructor} constructor - The element class\r\n */\r\nexport function register(name, constructor) {\r\n  if (!customElements.get(name)) {\r\n    customElements.define(name, constructor)\r\n  }\r\n}\r\n","/**\r\n * ytz-popover - Click-triggered positioned content Web Component.\r\n * Shows interactive content anchored to a trigger element.\r\n *\r\n * @module @grimoire/yetzirah-core/popover\r\n * @example\r\n * <ytz-popover>\r\n *   <button>Open menu</button>\r\n *   <div slot=\"content\">\r\n *     <p>Popover content with interactive elements</p>\r\n *     <button onclick=\"this.closest('ytz-popover').open = false\">Close</button>\r\n *   </div>\r\n * </ytz-popover>\r\n *\r\n * @example\r\n * // With placement\r\n * <ytz-popover placement=\"bottom\">\r\n *   <button>Settings</button>\r\n *   <div slot=\"content\" class=\"pa3 bg-white shadow-2 br2\">\r\n *     <label class=\"db mb2\">\r\n *       <input type=\"checkbox\"> Enable notifications\r\n *     </label>\r\n *     <button>Save</button>\r\n *   </div>\r\n * </ytz-popover>\r\n */\r\n\r\nimport { position } from './utils/position.js'\r\nimport { register } from './utils/register.js'\r\n\r\nlet popoverId = 0\r\n\r\n/** @type {string} Selector for focusable elements */\r\nconst FOCUSABLE = 'a[href], button:not([disabled]), input:not([disabled]), select:not([disabled]), textarea:not([disabled]), [tabindex]:not([tabindex=\"-1\"])'\r\n\r\n/**\r\n * @class YtzPopover\r\n * @extends HTMLElement\r\n */\r\nclass YtzPopover extends HTMLElement {\r\n  static observedAttributes = ['open', 'placement', 'offset']\r\n\r\n  /** @type {HTMLElement|null} */\r\n  #trigger = null\r\n  /** @type {HTMLElement|null} */\r\n  #content = null\r\n  /** @type {string|null} */\r\n  #contentId = null\r\n\r\n  connectedCallback() {\r\n    this.#setup()\r\n    // Check initial open state\r\n    if (this.hasAttribute('open')) {\r\n      this.#show()\r\n    }\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    this.#cleanup()\r\n  }\r\n\r\n  attributeChangedCallback(name, oldVal, newVal) {\r\n    if (!this.isConnected) return\r\n\r\n    if (name === 'open') {\r\n      newVal !== null ? this.#show() : this.#hide()\r\n    } else if (this.hasAttribute('open')) {\r\n      // Reposition if placement/offset changed while open\r\n      this.#updatePosition()\r\n    }\r\n  }\r\n\r\n  /** @returns {'top'|'bottom'|'left'|'right'} */\r\n  get placement() {\r\n    return this.getAttribute('placement') || 'bottom'\r\n  }\r\n\r\n  set placement(value) {\r\n    this.setAttribute('placement', value)\r\n  }\r\n\r\n  /** @returns {number} */\r\n  get offset() {\r\n    return parseInt(this.getAttribute('offset') || '8', 10)\r\n  }\r\n\r\n  set offset(value) {\r\n    this.setAttribute('offset', String(value))\r\n  }\r\n\r\n  /** @returns {boolean} */\r\n  get open() {\r\n    return this.hasAttribute('open')\r\n  }\r\n\r\n  set open(value) {\r\n    if (value) {\r\n      this.setAttribute('open', '')\r\n    } else {\r\n      this.removeAttribute('open')\r\n    }\r\n  }\r\n\r\n  #setup() {\r\n    // Find trigger (first child) and content ([slot=\"content\"] or last child)\r\n    this.#trigger = this.firstElementChild\r\n    this.#content = this.querySelector('[slot=\"content\"]') || this.lastElementChild\r\n\r\n    if (!this.#trigger || !this.#content || this.#trigger === this.#content) return\r\n\r\n    // Generate unique ID for content\r\n    this.#contentId = this.#content.id || `ytz-popover-${++popoverId}`\r\n    this.#content.id = this.#contentId\r\n\r\n    // Set up ARIA - popover uses aria-expanded on trigger\r\n    this.#trigger.setAttribute('aria-haspopup', 'dialog')\r\n    this.#trigger.setAttribute('aria-expanded', 'false')\r\n    this.#trigger.setAttribute('aria-controls', this.#contentId)\r\n\r\n    // Content hidden initially\r\n    this.#content.hidden = true\r\n\r\n    // Click listener on trigger\r\n    this.#trigger.addEventListener('click', this.#handleTriggerClick)\r\n  }\r\n\r\n  #cleanup() {\r\n    this.#trigger?.removeEventListener('click', this.#handleTriggerClick)\r\n    document.removeEventListener('click', this.#handleOutsideClick)\r\n    document.removeEventListener('keydown', this.#handleEscape)\r\n    window.removeEventListener('scroll', this.#updatePosition, { capture: true })\r\n    window.removeEventListener('resize', this.#updatePosition)\r\n  }\r\n\r\n  #handleTriggerClick = (e) => {\r\n    e.stopPropagation()\r\n    this.open = !this.open\r\n  }\r\n\r\n  #handleOutsideClick = (e) => {\r\n    // Close if click is outside popover content and trigger\r\n    if (!this.#content?.contains(e.target) && !this.#trigger?.contains(e.target)) {\r\n      this.open = false\r\n    }\r\n  }\r\n\r\n  #handleEscape = (e) => {\r\n    if (e.key === 'Escape' && this.open) {\r\n      e.preventDefault()\r\n      this.open = false\r\n      // Return focus to trigger\r\n      this.#trigger?.focus()\r\n    }\r\n  }\r\n\r\n  #show() {\r\n    if (!this.#content) return\r\n\r\n    // Update ARIA\r\n    this.#trigger?.setAttribute('aria-expanded', 'true')\r\n\r\n    // Show content\r\n    this.#content.hidden = false\r\n    this.#updatePosition()\r\n\r\n    // Add listeners for dismiss\r\n    // Use setTimeout to avoid immediate close from the same click\r\n    setTimeout(() => {\r\n      document.addEventListener('click', this.#handleOutsideClick)\r\n    }, 0)\r\n    document.addEventListener('keydown', this.#handleEscape)\r\n\r\n    // Reposition on scroll/resize\r\n    window.addEventListener('scroll', this.#updatePosition, { passive: true, capture: true })\r\n    window.addEventListener('resize', this.#updatePosition, { passive: true })\r\n\r\n    // Focus first focusable element in content\r\n    requestAnimationFrame(() => {\r\n      const focusable = this.#content?.querySelector(FOCUSABLE)\r\n      if (focusable) {\r\n        /** @type {HTMLElement} */ (focusable).focus()\r\n      }\r\n    })\r\n\r\n    this.dispatchEvent(new CustomEvent('show', { bubbles: true }))\r\n  }\r\n\r\n  #hide() {\r\n    if (!this.#content) return\r\n\r\n    // Update ARIA\r\n    this.#trigger?.setAttribute('aria-expanded', 'false')\r\n\r\n    // Hide content\r\n    this.#content.hidden = true\r\n\r\n    // Remove listeners\r\n    document.removeEventListener('click', this.#handleOutsideClick)\r\n    document.removeEventListener('keydown', this.#handleEscape)\r\n    window.removeEventListener('scroll', this.#updatePosition, { capture: true })\r\n    window.removeEventListener('resize', this.#updatePosition)\r\n\r\n    this.dispatchEvent(new CustomEvent('hide', { bubbles: true }))\r\n  }\r\n\r\n  #updatePosition = () => {\r\n    if (!this.#trigger || !this.#content) return\r\n\r\n    const { x, y, placement: finalPlacement } = position(this.#trigger, this.#content, {\r\n      placement: this.placement,\r\n      offset: this.offset\r\n    })\r\n\r\n    // Position popover fixed relative to viewport\r\n    this.#content.style.position = 'fixed'\r\n    this.#content.style.left = `${x}px`\r\n    this.#content.style.top = `${y}px`\r\n\r\n    // Set data attribute for CSS styling based on actual placement\r\n    this.#content.dataset.placement = finalPlacement\r\n  }\r\n\r\n  // Public API\r\n\r\n  /** Show the popover programmatically */\r\n  show() {\r\n    this.open = true\r\n  }\r\n\r\n  /** Hide the popover programmatically */\r\n  hide() {\r\n    this.open = false\r\n  }\r\n\r\n  /** Toggle the popover open/closed */\r\n  toggle() {\r\n    this.open = !this.open\r\n  }\r\n}\r\n\r\nregister('ytz-popover', YtzPopover)\r\n\r\nexport { YtzPopover }\r\n"]}