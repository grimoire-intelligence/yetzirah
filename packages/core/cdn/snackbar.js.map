{"version":3,"sources":["../src/utils/register.js","../src/snackbar.js"],"names":["register","name","constructor","snackbarQueues","VALID_POSITIONS","YtzSnackbar","#dismissTimer","#closeButton","#isPaused","#pendingDismissReason","#setupCloseButton","#handleMouseEnter","#handleMouseLeave","#show","#cleanup","oldVal","newVal","reason","#hide","#removeFromQueue","#addToQueue","#handleClose","#clearTimer","#startTimer","e","pos","queue","#enforceMaxVisible","#updateOffsets","index","max","offset","snackbar","height","message","closeBtn","value","val"],"mappings":"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","file":"snackbar.js","sourcesContent":["/**\n * Idempotent custom element registration utility.\n * Prevents duplicate registration errors when scripts load multiple times.\n *\n * @module @grimoire/yetzirah-core/utils/register\n * @internal Not exported from package\n */\n\n/**\n * Register a custom element if not already registered.\n * Safe to call multiple times with the same name.\n *\n * @param {string} name - Custom element tag name (e.g., 'ytz-button')\n * @param {CustomElementConstructor} constructor - The element class\n */\nexport function register(name, constructor) {\n  if (!customElements.get(name)) {\n    customElements.define(name, constructor)\n  }\n}\n","/**\n * ytz-snackbar - Transient notification Web Component.\n * Provides auto-dismissing notifications with queue management and positioning.\n *\n * @module @grimoire/yetzirah-core/snackbar\n * @example\n * <ytz-snackbar id=\"snack\">File saved successfully</ytz-snackbar>\n *\n * @example\n * // Show snackbar programmatically\n * document.getElementById('snack').show()\n *\n * @example\n * // Positioned snackbar with custom duration\n * <ytz-snackbar position=\"top-right\" duration=\"3000\">\n *   Quick message\n * </ytz-snackbar>\n */\n\nimport { register } from './utils/register.js'\n\n/** @type {Map<string, YtzSnackbar[]>} Queue of active snackbars by position */\nconst snackbarQueues = new Map()\n\n/** Valid position values */\nconst VALID_POSITIONS = ['top-left', 'top-center', 'top-right', 'bottom-left', 'bottom-center', 'bottom-right']\n\n/**\n * @class YtzSnackbar\n * @extends HTMLElement\n */\nclass YtzSnackbar extends HTMLElement {\n  static observedAttributes = ['open', 'duration', 'position', 'dismissible', 'max-visible']\n\n  /** @type {number|null} */\n  #dismissTimer = null\n  /** @type {HTMLButtonElement|null} */\n  #closeButton = null\n  /** @type {boolean} */\n  #isPaused = false\n  /** @type {string|null} */\n  #pendingDismissReason = null\n\n  connectedCallback() {\n    // Set up accessibility attributes\n    this.setAttribute('role', 'status')\n    this.setAttribute('aria-live', 'polite')\n    this.setAttribute('aria-atomic', 'true')\n\n    // Initialize visibility\n    if (!this.hasAttribute('open')) {\n      this.hidden = true\n    }\n\n    // Set up close button if dismissible\n    this.#setupCloseButton()\n\n    // Set up hover pause behavior\n    this.addEventListener('mouseenter', this.#handleMouseEnter)\n    this.addEventListener('mouseleave', this.#handleMouseLeave)\n\n    // If already open, register in queue\n    if (this.hasAttribute('open')) {\n      this.#show()\n    }\n  }\n\n  disconnectedCallback() {\n    this.#cleanup()\n    this.removeEventListener('mouseenter', this.#handleMouseEnter)\n    this.removeEventListener('mouseleave', this.#handleMouseLeave)\n  }\n\n  attributeChangedCallback(name, oldVal, newVal) {\n    if (!this.isConnected) return\n\n    if (name === 'open') {\n      if (newVal !== null) {\n        this.#show()\n      } else {\n        // Use pending reason if set (e.g., from timeout), otherwise 'manual'\n        const reason = this.#pendingDismissReason || 'manual'\n        this.#pendingDismissReason = null\n        this.#hide(reason)\n      }\n    } else if (name === 'dismissible') {\n      this.#setupCloseButton()\n    } else if (name === 'position') {\n      // Re-register in correct queue if position changes while open\n      if (this.hasAttribute('open') && oldVal !== newVal) {\n        this.#removeFromQueue(oldVal || 'bottom-center')\n        this.#addToQueue()\n      }\n    }\n  }\n\n  #setupCloseButton() {\n    // Remove existing button if any\n    this.#closeButton?.remove()\n    this.#closeButton = null\n\n    if (this.dismissible) {\n      this.#closeButton = document.createElement('button')\n      this.#closeButton.type = 'button'\n      this.#closeButton.setAttribute('aria-label', 'Dismiss')\n      this.#closeButton.className = 'ytz-snackbar-close'\n      this.#closeButton.textContent = '\\u00D7'\n      this.#closeButton.addEventListener('click', this.#handleClose)\n      this.appendChild(this.#closeButton)\n    }\n  }\n\n  #show() {\n    // Clear any pending dismiss\n    this.#clearTimer()\n\n    // Show the snackbar\n    this.hidden = false\n\n    // Add to position queue\n    this.#addToQueue()\n\n    // Set up auto-dismiss timer\n    if (this.duration > 0) {\n      this.#startTimer()\n    }\n  }\n\n  #hide(reason = 'manual') {\n    this.#clearTimer()\n    this.hidden = true\n    this.#removeFromQueue(this.position)\n\n    // Dispatch dismiss event\n    this.dispatchEvent(new CustomEvent('dismiss', {\n      bubbles: true,\n      detail: { reason }\n    }))\n  }\n\n  #startTimer() {\n    this.#dismissTimer = window.setTimeout(() => {\n      // Set pending reason before removing attribute (triggers attributeChangedCallback)\n      this.#pendingDismissReason = 'timeout'\n      this.removeAttribute('open')\n    }, this.duration)\n  }\n\n  #clearTimer() {\n    if (this.#dismissTimer !== null) {\n      clearTimeout(this.#dismissTimer)\n      this.#dismissTimer = null\n    }\n  }\n\n  #handleMouseEnter = () => {\n    if (this.duration > 0 && this.#dismissTimer !== null) {\n      this.#isPaused = true\n      this.#clearTimer()\n    }\n  }\n\n  #handleMouseLeave = () => {\n    if (this.#isPaused && this.hasAttribute('open')) {\n      this.#isPaused = false\n      this.#startTimer()\n    }\n  }\n\n  #handleClose = (e) => {\n    e.stopPropagation()\n    this.removeAttribute('open')\n  }\n\n  #addToQueue() {\n    const pos = this.position\n    if (!snackbarQueues.has(pos)) {\n      snackbarQueues.set(pos, [])\n    }\n\n    const queue = snackbarQueues.get(pos)\n    if (!queue.includes(this)) {\n      queue.push(this)\n    }\n\n    // Enforce max-visible limit\n    this.#enforceMaxVisible()\n    this.#updateOffsets()\n  }\n\n  #removeFromQueue(pos) {\n    const queue = snackbarQueues.get(pos)\n    if (queue) {\n      const index = queue.indexOf(this)\n      if (index > -1) {\n        queue.splice(index, 1)\n        this.#updateOffsets()\n      }\n    }\n  }\n\n  #enforceMaxVisible() {\n    const queue = snackbarQueues.get(this.position) || []\n    const max = this.maxVisible\n\n    // Remove oldest snackbars if queue exceeds max\n    while (queue.length > max) {\n      const oldest = queue[0]\n      oldest.removeAttribute('open')\n    }\n  }\n\n  #updateOffsets() {\n    const pos = this.position\n    const queue = snackbarQueues.get(pos) || []\n    const isTop = pos.startsWith('top')\n\n    let offset = 0\n    for (const snackbar of queue) {\n      snackbar.style.setProperty('--ytz-snackbar-offset', `${offset}px`)\n      // Measure height for next snackbar's offset\n      const height = snackbar.offsetHeight || 0\n      offset += height + 8 // 8px gap between stacked snackbars\n    }\n  }\n\n  #cleanup() {\n    this.#clearTimer()\n    this.#removeFromQueue(this.position)\n    this.#closeButton?.removeEventListener('click', this.#handleClose)\n  }\n\n  // Public methods\n\n  /**\n   * Show the snackbar, optionally updating its message content.\n   * @param {string} [message] - Optional message to display\n   */\n  show(message) {\n    if (message !== undefined) {\n      // Update text content while preserving close button\n      const closeBtn = this.#closeButton\n      this.textContent = message\n      if (closeBtn && this.dismissible) {\n        this.appendChild(closeBtn)\n      }\n    }\n    this.setAttribute('open', '')\n  }\n\n  /**\n   * Dismiss the snackbar programmatically.\n   */\n  dismiss() {\n    this.removeAttribute('open')\n  }\n\n  // Property getters/setters\n\n  /**\n   * Get/set the open state.\n   * @type {boolean}\n   */\n  get open() {\n    return this.hasAttribute('open')\n  }\n\n  set open(value) {\n    if (value) {\n      this.setAttribute('open', '')\n    } else {\n      this.removeAttribute('open')\n    }\n  }\n\n  /**\n   * Get/set the auto-dismiss duration in milliseconds.\n   * @type {number}\n   */\n  get duration() {\n    const val = this.getAttribute('duration')\n    return val !== null ? parseInt(val, 10) : 5000\n  }\n\n  set duration(value) {\n    this.setAttribute('duration', String(value))\n  }\n\n  /**\n   * Get/set the position.\n   * @type {string}\n   */\n  get position() {\n    const pos = this.getAttribute('position')\n    return VALID_POSITIONS.includes(pos) ? pos : 'bottom-center'\n  }\n\n  set position(value) {\n    if (VALID_POSITIONS.includes(value)) {\n      this.setAttribute('position', value)\n    }\n  }\n\n  /**\n   * Get/set whether the close button is shown.\n   * @type {boolean}\n   */\n  get dismissible() {\n    return this.hasAttribute('dismissible')\n  }\n\n  set dismissible(value) {\n    if (value) {\n      this.setAttribute('dismissible', '')\n    } else {\n      this.removeAttribute('dismissible')\n    }\n  }\n\n  /**\n   * Get/set the maximum number of visible snackbars at this position.\n   * @type {number}\n   */\n  get maxVisible() {\n    const val = this.getAttribute('max-visible')\n    return val !== null ? parseInt(val, 10) : 3\n  }\n\n  set maxVisible(value) {\n    this.setAttribute('max-visible', String(value))\n  }\n}\n\nregister('ytz-snackbar', YtzSnackbar)\n\nexport { YtzSnackbar }\n"]}